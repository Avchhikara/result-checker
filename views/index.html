<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <title>Get Notified when the result is out!!</title>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-lg-6 col-xl-5 mx-auto card mt-5 mb-5">
          <div class="card-body">
            <div id="message"></div>
            <div
              style="border-left:2px solid red; padding-left: 8px; padding-bottom:10px;"
              class="h5"
            >
              Want to get <strong>notified</strong> everytime the
              <strong>result</strong> is out?
            </div>
            <div class="text-muted">
              <em>if yes, then just fill the form below ðŸ‘‡</em>
            </div>
            <form id="form" class="mt-4" onsubmit="formsubmit">
              <div class="form-group row">
                <label for="name" class="col-sm-3 col-form-label">Name</label>
                <div class="col-sm-9">
                  <input
                    type="text"
                    name="name"
                    id="name"
                    class="form-control"
                  />
                </div>
              </div>
              <div class="form-group row">
                <label for="email" class="col-sm-3 col-form-label">Email</label>
                <div class="col-sm-9">
                  <input
                    type="email"
                    name="email"
                    id="email"
                    class="form-control"
                  />
                </div>
              </div>
              <div class="form-group row">
                <label for="sem" class="col-sm-3 col-form-label">Sem</label>
                <div class="col-sm-9">
                  <select class="custom-select" id="sem">
                    <option selected value="0"
                      >Select your current Semester</option
                    >
                    <option value="1">1st</option>
                    <option value="2">2nd</option>
                    <option value="3">3rd</option>
                    <option value="1">4th</option>
                    <option value="2">5th</option>
                    <option value="3">6th</option>
                    <option value="1">7th</option>
                    <option value="2">8th</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="branch" class="col-sm-3 col-form-label"
                  >Branch</label
                >
                <div class="col-sm-9">
                  <select class="custom-select" id="branch">
                    <option selected value="0">Select your branch</option>
                  </select>
                </div>
              </div>
              <div class="text-center mt-5">
                <button type="submit" class="btn btn-outline-danger">
                  Submit
                </button>
              </div>
            </form>
          </div>
          <div
            class="card-footer text-center text-muted"
            style="background-color: white;"
          >
            &copy; <a href="https://github.com/avchhikara">AvChhikara</a> | 2019
          </div>
        </div>
      </div>
    </div>
  </body>
  <script>
    // Now, making page dynamic to respond to errors
    const url = location.search.split("=");
    const message = url[1];
    const message_type = url[0].includes("error") ? "danger" : "success";
    const message_element = document.querySelector("#message");

    showMessage(message && decodeURI(message), message_type); // Calling the function to show the message

    // Here, some simple commands
    const form = document.querySelector("form");
    const button = document.querySelector("button");
    const name = document.querySelector("#name");
    const email = document.querySelector("#email");
    const sem = document.querySelector("#sem");
    const branch = document.querySelector("#branch");

    form.addEventListener("submit", formsubmit);
    function formsubmit(e) {
      e.preventDefault();
      // Now, doing the validation of the data
      const validate_result = validate();
      if (validate_result.status) {
        console.log("All the values are provided", sem.value, branch.value);
      } else {
        location.href =
          location.origin +
          location.pathname +
          `?error=${validate_result.message}`;
      }
    }

    // This function is for the simple validation
    function validate() {
      let message = "All the values are validated";
      let status = true;
      if (!name.value) {
        status = false;
        message = "Please provide name";
      } else if (!email.value) {
        status = false;
        message = "Please provide email";
      } else if (sem.value === "0") {
        status = false;
        message = "Please select your semester";
      } else if (branch.value === "0") {
        status = false;
        message = "Please select your branch";
      }
      return { message, status };
    }

    // This function shows message to user
    function showMessage(message, type) {
      if (message) {
        const alert = document.createElement("div");
        alert.className = `alert alert-${type}`;
        alert.textContent = message;
        message_element.appendChild(alert);
        alert.scrollIntoView({ behavior: "smooth" });
        setTimeout(hideMessage, 5000);
      }
    }
    function hideMessage() {
      message_element.innerHTML = "";
    }
  </script>
</html>
